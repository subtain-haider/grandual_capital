(()=>{"use strict";$(document).ready((function(){$("#filter_user").select2({minimumResultsForSearch:-1,placeholder:"Select Status (ALL)"}),$("#privacy_filter").select2({minimumResultsForSearch:-1,placeholder:"Select Privacy"});var e=$("#users_table").DataTable({processing:!0,serverSide:!0,bStateSave:!0,order:[[1,"asc"]],ajax:{url:usersUrl,data:function(e){e.filter_user=$("#filter_user").find("option:selected").val(),e.privacy_filter=$("#privacy_filter").find("option:selected").val()}},columnDefs:[{targets:[0]},{targets:[3,4,5,6],orderable:!1,className:"text-center",width:"10%"}],columns:[{data:function(e){return'<div class="d-flex align-items-center"> <div class="symbol symbol-circle symbol-50px overflow-hidden mr-3"> <a href="javascript:void(0)"> <div> <img src="'.concat(e.photo_url,'" alt="User Image" class="user-avatar-img"> </div> </a> </div> <div class="d-flex flex-column"> <a href="javascript:void(0)" class="mb-1 user-name-data">').concat(htmlSpecialCharsDecode(e.name),'</a> <span class="user-email-data">').concat(e.email,"</span> </div> </div> ")},name:"name"},{data:function(e){var a=getRoleName(e.roles);return htmlSpecialCharsDecode(a)},name:"email"},{data:function(e){return e.privacy?'<span class="public-badge py-1 px-2">Public</span>':'<span class="private-badge py-1 px-2">Private</span>'},name:"privacy",searchable:!1},{data:function(e){var a=null===e.email_verified_at?"":"checked disabled";return' <label class="switch switch-label switch-outline-primary-alt"><input name="email_verified" data-id="'+e.id+'" class="switch-input email-verified" type="checkbox" '+a+'><span class="switch-slider" data-checked="&#x2713;" data-unchecked="&#x2715;"></span></label>'},name:"id"},{data:function(e){var a=0===e.is_active?"":"checked";return' <label class="switch switch-label switch-outline-primary-alt"><input name="is_active" data-id="'+e.id+'" class="switch-input is-active" type="checkbox" value="1" '+a+'><span class="switch-slider" data-checked="&#x2713;" data-unchecked="&#x2715;"></span></label>'},name:"id"},{data:function(e){return'<a title="" href="'.concat(usersUrl+"/"+e.id+"/login",'" class="btn btn-primary btn-sm">\n                               Impersonate\n                            </a>')},name:"id"},{data:function(e){var a={isArchive};return $.templates("#tmplAddChatUsersList").render(e,a)},name:"id"}],drawCallback:function(){this.api().state.clear()},fnInitComplete:function(){$("#filter_user").change((function(){e.ajax.reload()})),$("#privacy_filter").change((function(){e.ajax.reload()}))}});window.isArchive=function(e){return null!=e?1:0},window.getRoleName=function(e){var a="";return $.each(e,(function(e,t){return a=t.name,!1})),a},$("#createUserForm").on("submit",(function(e){e.preventDefault();var a=jQuery(this).find("#createBtnSave");a.button("loading"),$.ajax({url:createUserUrl,type:"post",data:new FormData($(this)[0]),processData:!1,contentType:!1,success:function(e){e.success&&(displayToastr("Success","success",e.message),$("#create_user_modal").modal("hide"),$("#users_table").DataTable().ajax.reload(null,!1))},error:function(e){displayToastr("Error","error",e.responseJSON.message)},complete:function(){a.button("reset")}})})),$("#editUserForm").on("submit",(function(e){e.preventDefault();var a=jQuery(this).find("#editBtnSave");a.button("loading");var t=$("#edit_user_id").val();$.ajax({url:usersUrl+"/"+t+"/update",type:"post",data:new FormData($(this)[0]),processData:!1,contentType:!1,success:function(e){e.success&&(displayToastr("Success","success",e.message),$("#edit_user_modal").modal("hide"),$("#users_table").DataTable().ajax.reload(null,!1))},error:function(e){displayToastr("Error","error",e.responseJSON.message)},complete:function(){a.button("reset")}})})),$(document).on("click",".edit-btn",(function(){var e=$(this).data("id");renderData(usersUrl+"/"+e+"/edit")})),window.renderData=function(e){$.ajax({url:e,type:"GET",success:function(e){if(e.success){var a=e.data.user;$("#edit_user_id").val(a.id),$("#edit_name").val(htmlSpecialCharsDecode(a.name)),$("#edit_email").val(a.email),$("#edit_phone").val(a.phone),$("#edit_is_active").val(a.is_active),$("#edit_role_id").val(a.role_id),$("#edit_upload-photo-img").attr("src",a.photo_url),$("#edit_about").val(htmlSpecialCharsDecode(a.about)),$("#edit_user_modal").modal("show"),1==a.gender&&$("#edit_male").prop("checked",!0),2==a.gender&&$("#edit_female").prop("checked",!0),1==a.privacy?$("#editPrivacyPublic").prop("checked",!0):$("#editPrivacyPrivate").prop("checked",!0)}},error:function(e){displayToastr("Error","error",e.responseJSON.message)}})};var a=Swal.mixin({customClass:{confirmButton:"btn btn-danger mr-2 btn-lg",cancelButton:"btn btn-secondary btn-lg"},buttonsStyling:!1});function t(e,a){$(e)[0].reset(),$(a).hide()}$(document).on("click",".delete-btn",(function(e){var t=$(this).data("id");!function(e,t,r){a.fire({title:"Are you sure?",html:'Are you sure want to delete this "'+r+'" ?',icon:"warning",showCancelButton:!0,confirmButtonText:"Delete",input:"text",inputPlaceholder:'Write "delete" to delete this user',inputValidator:function(e){if("delete"!==e)return'You need to write "delete"'}}).then((function(a){a.value&&deleteItemAjax(e,t,r,null)}))}(usersUrl+"/"+t,"#users_table","User")})),$(document).on("click",".archive-btn",(function(){var e=$(this).data("id");!function(e,t,r){a.fire({title:"Are you sure?",input:"text",inputPlaceholder:'Write "archive" to archive this user',html:'want to archive this "'+r+'" ? After archive all its conversations will be archive.',icon:"warning",showCancelButton:!0,confirmButtonText:"Archive",inputValidator:function(e){if("archive"!==e)return'You need to write "archive"'}}).then((function(a){a.value&&archiveItemAjax(e,t,r,null)}))}(usersUrl+"/"+e+"/archive","#users_table","User")})),window.archiveItemAjax=function(e,a,t){$.ajax({url:e,type:"DELETE",dataType:"json",success:function(e){e.success&&$(a).DataTable().ajax.reload(null,!1),displayToastr("Success","success",e.message)},error:function(e){displayToastr("Error","error",e.responseJSON.message)}})},$(document).on("click",".restore-btn",(function(e){var a=$(this).data("id");!function(e,a,t,r){swal.fire({title:"Are you sure?",html:'want to restore this "'+t+'" ?',icon:"warning",showCancelButton:!0,confirmButtonText:"Restore"}).then((function(s){s.value&&restoreItemAjax(e,a,t,r)}))}(usersUrl+"/restore","#users_table","User",a)})),window.restoreItemAjax=function(e,a,t,r){$.ajax({url:e,type:"POST",data:{id:r},dataType:"json",success:function(e){e.success&&$(a).DataTable().ajax.reload(null,!1),displayToastr("Success","success",t+" has been restored.")},error:function(e){displayToastr("Error","error",e.responseJSON.message)}})},$("#create_user_modal").on("hidden.bs.modal",(function(){t("#createUserForm","#validationErrorsBox"),$("#upload-photo-img").attr("src",defaultImageAvatar)})),$("#edit_user_modal").on("hidden.bs.modal",(function(){t("#editUserForm","#editValidationErrorsBox")})),$(document).on("change",".is-active",(function(e){var a=$(e.currentTarget).data("id");activeDeActiveUser(a)})),window.activeDeActiveUser=function(e){$.ajax({url:usersUrl+"/"+e+"/active-de-active",method:"post",cache:!1,success:function(e){e.success&&(displayToastr("Success","success",e.message),$("#users_table").DataTable().ajax.reload(null,!1))}})},$(document).on("change",".email-verified",(function(e){var a=$(e.currentTarget).data("id");$.ajax({url:usersUrl+"/"+a+"/email-verified",method:"post",cache:!1,success:function(e){e.success&&(displayToastr("Success","success",e.message),$("#users_table").DataTable().ajax.reload(null,!1))}})})),window.validatePasswordConfirmation=function(){return""!==$("#confirm_password").val()||(displayToastr("Error","error","The password confirmation field is required."),!1)},window.validateMatchPasswords=function(){return $("#confirm_password").val()===$("#password").val()||(displayToastr("Error","error","The password and password confirmation did not match."),!1)},window.validatePassword=function(){return""!==$("#password").val()||(displayToastr("Error","error","The password field is required."),!1)}}))})();